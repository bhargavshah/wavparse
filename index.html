<!DOCTYPE html>
<html>
<head>
<title>Parse WAVE File</title>
<script src="wav.js"></script>
<script type="text/javascript" charset="utf-8" src="encoder.js"></script>
<script type="text/javascript" src="speex.min.js"></script>
<script type="text/javascript" src="jquery-1.7.2.min.js"></script>
</head>
<body>
<h1>Parse WAVE file</h1>
<h5>Choose a file, then click Parse WAV</h5>
<input type="file" onchange="handleFiles(this.files)">
<button type="button" onclick="handleClick()">Parse WAV</button>
<script>

var _file;
var _wavFile;

function handleFiles(files) {
	_file = files[0];
}

function handleClick() {
	_wavFile = new wav(_file);
	_wavFile.onloadend = function () {
	// 'this' refers to the wav instance
	console.log(this);
	letsEncode();
	}; 
}

function letsEncode() {
	$(document).on('tn.recorder.encoded', function(e) { 
		alert('tn.recorder.encoded');
	});
    try {
        // alert('canYouEncode');
        var encoder = new Encoder();
        encoder.encodeSPXB64( _wavFile.dataSamples, 8);
    }
    catch (e) {
        alert('error encoding' + JSON.stringify(e));
    }
}


</script>
</body>
</html>